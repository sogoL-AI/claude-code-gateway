# T01: 深度字段提取分析

## 问题描述

Claude CLI会话数据是复杂的嵌套JSON结构，包含大量不规则的字段路径。为了全面了解数据结构，需要：

1. **字段爆炸问题**: 数组索引导致大量重复字段 (`content[0]`, `content[1]`, `content[2]` ...)
2. **深度嵌套**: 字段路径可达10+层深度，手工分析困难
3. **字段去重**: 需要将相似路径合并为统一表示 (`content[*]`)
4. **统计分析**: 了解字段出现频率和分布特征

## 技术挑战

- **递归遍历**: 需要深度优先遍历复杂JSON结构
- **路径规范化**: 将数组索引 `[0]`, `[1]`, `[2]` 统一为 `[*]`
- **内存优化**: 处理468个文件、3万+记录的大规模数据
- **去重算法**: 智能合并相似字段路径

## 预期结果

### 输出文件
- `deduplicated_fields.json` - 去重后的字段清单
- `field_analysis_detailed.json` - 详细字段分析报告

### 关键指标
- **处理规模**: 468个Session文件，30,000+条记录
- **字段发现**: 预期发现200+个唯一字段路径
- **去重效率**: 将数千个原始字段路径合并为数百个规范路径
- **覆盖深度**: 支持10+层嵌套结构的完整遍历

### 实际成果
根据最新执行结果：
- ✅ 处理文件数: 468
- ✅ 处理记录数: 30,365
- ✅ 去重字段总数: 969 → 268 (去重率72%)
- ✅ 发现关键字段: `message.content[*].text`, `usage.output_tokens`, `timestamp` 等

## 使用方式

```bash
# 单独执行
python tasks/T01_deep_field_extraction/field_extractor.py outputs/T01_field_extraction

# 通过调度器执行
python task_scheduler.py --tasks T06 T01
```

## 依赖关系

- **输入依赖**: T06 数据源扫描结果
- **输出用途**: T08 前端展示策略设计的基础数据

## 技术实现

- **算法**: 递归深度优先遍历 + 正则表达式路径规范化
- **数据结构**: 字典去重 + 统计计数器
- **性能**: 支持GB级数据处理，执行时间 < 5秒